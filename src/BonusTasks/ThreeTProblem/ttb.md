## №5 Three T problem

## Демченко Георгий Павлович , БПИ-235

### Рекурентное соотношение T(n) и оценка верхней ассимтотической границы временной сложности

$$
T(n) = 
\begin{cases}
2 \cdot T(\frac{n}{2}) + n, \quad n \equiv 0 \space (\text{mod 2})\\
2 \cdot T(n - 1) + n, \quad n \equiv 1 \space (\text{mod 2})\\
T(1) = 1
\end{cases}
$$

### Нахождение худшего случая ветвление T(n)

$\forall n \in \mathbb{N}$ мы можем узнать количество удволетворений первому условию ветвления рекурсии ($n \equiv 0 \space (\text{mod 2})$), так как оно отражает значение степени двойки , входящей в делители числа $n$.

$\Rightarrow m_{1} = \lfloor log_2(n) \rfloor$ - степень двойки в делителях $n$ , кол-во удволетворений 1-ому ветвлению.

В общем случае найти кол-во удволетворений 2-ому условию ветвления невозможно (<i>вероятно, возможно, но сложно</i>), так как нам требуется обосновать вехную границу $T(n)$, то рассмотрим худший случай прохождения по ветвям рекурсии.

Так как после каждого прохода во 2-ую ветвь четность будет менятся и мы попадаем в 1-ую ветку, то мы не можем дальше гарантировать попадание во 2-ую ветку.

Поэтому худший случай будет образовываться , когда после каждого прохода в 1-ую ветку $\frac{n}{2} \equiv 1 \space (\text{mod 2})$ и мы попадаем во 2-ую ветку, откуда идем обратно в 1-ую и так далее до $n$ = 1.

Т.е худший случай происходит на числа $n$ образованных следующим способом:

$n = (((((1 \cdot 2) + 1) \cdot 2) + 1) \cdot 2) + 1 \dots \equiv 1 \space (\text{mod 2})$ - нечетное число

$\Rightarrow m_{2} = m_{1} =  \lfloor log_2(n) \rfloor$ - худший случай колиества вхождений во 2-ую ветку

 
### $T(n) = O(f(n))$

Учитывая вышесказанное, мы имеем:

$m = m_{1} + m_{2} = 2 \cdot \lfloor log_2(n) \rfloor$ - высота дерева рекурсии

$2^{i}$ - кол-во подзадач на уровне рекурсии

Затраты подзадач на уровне будут иметь вид (по убванию от вершины, где i = 0 - вершина с затратой n):

$n, n - 1, \frac{n-1}{2}, \frac{n-1}{2} - 1, \frac{\frac{n-1}{2} - 1}{2}, (\frac{\frac{n-1}{2} - 1}{2} - 1)\dots = n, n - 1, \frac{n-1}{2}, \frac{n-3}{2}, \frac{n-3}{4}, \frac{n-7}{4} \dots$

$\Rightarrow g_{i} = \frac{n - w_{i}}{2^{\lfloor \frac{i}{2} \rfloor}}$ - затраты на i-ом уровне ($\forall i \in [1, m]$, $g_{0} = n$)

Где $w_{i} = \sum_{j = 0}^{[\frac{i - 1}{2}]}(2^{j}) = (2^{[\frac{i + 1}{2}]} - 1)$, $\forall i \in [1, m]$

$\Rightarrow g_{i} = \frac{n - (2^{[\frac{i + 1}{2}]} - 1)}{2^{\lfloor \frac{i}{2} \rfloor}} $ - затраты на i-ом уровне ($\forall i \in [1, m]$, $g_{0} = n$)

### Точный O(f(n))

$\Rightarrow f(n) = n + \sum_{i = 1}^{m}(2^{i} \cdot g_{i}) = n + \sum_{i = 1}^{2\lfloor log_2(n) \rfloor}(2^{i} \cdot \frac{n - (2^{[\frac{i + 1}{2}]} - 1)}{2^{\lfloor \frac{i}{2} \rfloor}})$ 

Можно досчитать $f(n)$ путем раскрытия $[\frac{i}{2}]$ на случаи чет-нечет

### Менее точный O(f(n))

Будем считать , что $g_{i} = \frac{n}{2^{[\frac{i}{2}]}}$, что немного ухудшает оценку, но делает $f(n)$ наглядной

$\Rightarrow f(n) = \sum_{i = 0}^{}(2^{i} \cdot g_{i}) = \sum_{i = 0}^{2\lfloor log_2(n) \rfloor}(2^{i} \cdot \frac{n}{2^{[\frac{i}{2}]}}) = \sum_{i = 0}^{\lfloor log_2(n) \rfloor}(2^{\frac{2i}{2}} \cdot n) + \sum_{i = 1}^{\lfloor log_2(n) \rfloor}(2^{(\frac{2i -1}{2} + 1)} \cdot n) = $


$= n \cdot \left(\sum_{i = 0}^{\lfloor log_2(n) \rfloor}(2^{i}) + \sqrt{2} \cdot \sum_{i = 1}^{\lfloor log_2(n) \rfloor}(2^{i}) \right)= n \cdot \left( 2^{(\lfloor log_2(n) \rfloor + 1)} - 1+ \sqrt{2} \cdot 2 \cdot (2^{\lfloor log_2(n) \rfloor} - 1) \right) = $

$= n \cdot (2^{(\lfloor log_2(n) \rfloor + 1)} \cdot (1 + \sqrt{2}) - (1 + 2^{\frac{3}{2}})) = n \cdot (2n \cdot (1 + \sqrt{2}) - (1 + 2^{\frac{3}{2}})) = $

$= n^2 \cdot(2 + 2^{\frac{3}{2}}) - n \cdot(1 + 2^{\frac{3}{2}})$

$\Rightarrow  T(n) = O(n^2 \cdot(2 + 2^{\frac{3}{2}}) - n \cdot(1 + 2^{\frac{3}{2}})) = O(n^2)$

