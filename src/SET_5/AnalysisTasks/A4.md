## A4. Совместимость фильтров Блума 

## Демченко Георгий Павлович , БПИ-235

### 1. $F(AB)$

Будем считать что для элементов из множеств $A$ и $B$ использовались одинаковые хеш-функции при составлении соотвествующих фильтров Блума.

При таком подходе фильтр $F(AB)$ будет выдавать положительные ответы о принадлежности объектов из множества $A \space \cap \space B$, так как :

$\forall c \in A \space \cap \space B: \space \forall h_{i} : \space \space \left( \space T_{F(A)}[h_{i}(c)] = T_{F(B)}[h_{i}(c)] = 1 \space \right) \space \Rightarrow T_{F(AB)}[h_{i}(c)] = 1 \space \& \space  1 = 1$

где 

$h_{i}$ - $i$-ая хэш-функция, использовавшаяся для вычисления хэша элемента при вставке в фильтр 

$T_{F}$ - внутренняя таблица соответсвующего фильтра 

$T_{F}[...]$ - элемент внутренней таблицы соотвествующего фильтра

Говоря словами, если элемент $c \in A \space \cap \space B$, то соответсвующие его хэшам элементы в филтрах $F(A)$ и $F(B)$ будут иметь одинаковые позиции (индексы) в внутренних таблицах и будут равны 1. Тогда при образовании фильтра $F(AB)$ с помощью поэлементного побитового И они также перенесутся во внутренную таблицу $F(AB)$ на те же позиции (индесы), так как $1 \space \& \space 1 = 1$

Получаем

$\forall c \in A \space \cap \space B: \space \forall h_{i} : T_{F(AB)}[h_{i}(c)] = 1 \Rightarrow F(AB)[c] = true$

**Ответ**: Да, верно

### 2. $F(AB)$ ?= $F(A \space \cap \space B)$

Нет, $F(AB)$ не всегда будет в точности соответсвовать фильтру $F(A \space \cap \space B)$, полученному вставкой объектов из множества $A \space \cap \space B$, так как :

Таблица фильтра $F(AB)$ может содержать лишние биты , по сравнению с таблицей $F(A \space \cap \space B)$, образованные пересечением 1 из таблиц фильтров $F(A)$ и $F(B)$ на позициях хешей элементов, которые не лежат в $A \space \cap \space B$.

Может произойти ситуация, где:

$\exists a_{1} \in A \setminus B, \space  b_{1} \in B \setminus A, \space a_{1} \neq b_{1}: \exists h_{n} : h_{n}(a_{1}) = h_{n}(b_{1})$

$\Rightarrow T_{F(A)}[h_{n}(a_{1})] = T_{F(B)}[h_{n}(b_{1})] = 1$

$\Rightarrow T_{F(AB)}[h_{n}(b_{1})] = 1 \space \& \space 1 = 1$

Т.е образуется коллизция элементов , не принадлежащих $A \space \cap \space B$, в таблицах $F(A)$ и $F(B)$, тогда в таблице $F(AB)$ появятся лишние 1 на позициях, которые не соотвествуют позициям из $F(A \space \cap \space B)$, что может дополнительно (помимо коллизий) привести к ложно-положительному ответу $F(AB)$ на принадлежность елементу не из $A \space \cap \space B$ множеству $A \space \cap \space B$.

**Ответ**: Нет, неверно
